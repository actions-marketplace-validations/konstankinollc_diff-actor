
name: konstankino-diff-actor
description: diffs the code
icon: "activity"
color: "blue"

on:
  push:
    branches:
      - "*"

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - name: Run the differ
        run:  |
          git diff ${{ github.event.before }} ${{ github.event.after }} > most-recent.diff
          curl -X POST -H "x-api-key: ${{ secrets.API_KEY }}" -H "Content-Type: text/xml" --data-binary "@most-recent.diff" --header "Name: ${{github.event.head_commit.author.name}}" --header "Email: ${{github.event.head_commit.author.email}}" --header "Username: ${{github.event.head_commit.author.username}}" --header "Repository: ${{ github.repository }}" ${{ secrets.POST_ENDPOINT }}/${{github.actor}}/${{github.sha}}
          
